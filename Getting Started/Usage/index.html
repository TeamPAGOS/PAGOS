
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PAGOS Documentation">
      
      
      
        <link rel="canonical" href="https://teampagos.github.io/pagos/Getting%20Started/Usage/">
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../../User%20Guide/Quantities%20and%20Magnitudes/">
      
      
      <link rel="icon" href="../../img/PAGOS_logo_O_Bright2-cropped.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Usage - PAGOS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M13%209h-2V7h2m0%2010h-2v-6h2m-1-9A10%2010%200%200%200%202%2012a10%2010%200%200%200%2010%2010%2010%2010%200%200%200%2010-10A10%2010%200%200%200%2012%202%22/%3E%3C/svg%3E');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PAGOS" class="md-header__button md-logo" aria-label="PAGOS" data-md-component="logo">
      
  <img src="../../img/PAGOS_Logo_O_Bright-cropped.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PAGOS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/TeamPAGOS/PAGOS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PAGOS
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PAGOS" class="md-nav__button md-logo" aria-label="PAGOS" data-md-component="logo">
      
  <img src="../../img/PAGOS_Logo_O_Bright-cropped.svg" alt="logo">

    </a>
    PAGOS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/TeamPAGOS/PAGOS" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PAGOS
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-quantities-are-defined-in-pagos" class="md-nav__link">
    <span class="md-ellipsis">
      How quantities are defined in PAGOS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#water-property-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Water property calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gas-property-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Gas property calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-and-fitting-models" class="md-nav__link">
    <span class="md-ellipsis">
      Creating and fitting models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inverse-modelling" class="md-nav__link">
    <span class="md-ellipsis">
      Inverse Modelling
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/Quantities%20and%20Magnitudes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantities and Magnitudes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/Functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../User%20Guide/Modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modelling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Development/Contributing.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    None
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-quantities-are-defined-in-pagos" class="md-nav__link">
    <span class="md-ellipsis">
      How quantities are defined in PAGOS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#water-property-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Water property calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gas-property-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Gas property calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-and-fitting-models" class="md-nav__link">
    <span class="md-ellipsis">
      Creating and fitting models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inverse-modelling" class="md-nav__link">
    <span class="md-ellipsis">
      Inverse Modelling
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="usage">Usage</h1>
<p>This is a relatively abridged version of the information you can find in <code>example scripts</code>.</p>
<h2 id="how-quantities-are-defined-in-pagos">How quantities are defined in PAGOS</h2>
<p>This package is designed with a number of "numerical safeguards". Quantities used in PAGOS may contain units, and uncertainties. Functions in PAGOS are designed for use with <code>Quantity</code> objects from <a href="https://pint.readthedocs.io/en/stable/">Pint</a>, but can also be used with regular Python datatypes. The following code produces such a quantity representing the speed 11.2 m/s.
<div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos</span><span class="w"> </span><span class="kn">import</span> <span class="n">Q</span>
</span><span id="__span-0-2"><span class="n">mySpeed</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="mf">11.2</span><span class="p">,</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
</span><span id="__span-0-3"><span class="nb">print</span><span class="p">(</span><span class="n">mySpeed</span><span class="p">)</span>
</span><span id="__span-0-4"><span class="c1"># -&gt; 11.2000 meter / second</span>
</span></code></pre></div>
Those familiar with Pint will recognise <code>Q()</code> as a shortcut for <code>pint.UnitRegistry.Quantity()</code>. This is the PAGOS-safe version though, as it will always refer to the universal <code>UnitRegistry</code> defined in <code>pagos.core</code>.</p>
<h2 id="water-property-calculations">Water property calculations</h2>
<p>The properties of seawater and various gases can be calculated with the <code>water</code> and <code>gas</code> modules. For example, calculating the density of, kinematic viscosity of and vapour pressure over water at a given temperature and salinity:
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos</span><span class="w"> </span><span class="kn">import</span> <span class="n">water</span> <span class="k">as</span> <span class="n">pwater</span>
</span><span id="__span-1-2"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos</span><span class="w"> </span><span class="kn">import</span> <span class="n">Q</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="n">myTemp1</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">)</span>
</span><span id="__span-1-5"><span class="n">mySal1</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;permille&#39;</span><span class="p">)</span>
</span><span id="__span-1-6">
</span><span id="__span-1-7"><span class="n">myDensity1</span> <span class="o">=</span> <span class="n">pwater</span><span class="o">.</span><span class="n">calc_dens</span><span class="p">(</span><span class="n">myTemp1</span><span class="p">,</span> <span class="n">mySal1</span><span class="p">)</span>
</span><span id="__span-1-8"><span class="n">myDensity2</span> <span class="o">=</span> <span class="n">pwater</span><span class="o">.</span><span class="n">calc_dens</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="c1"># &lt;- default units of degC and permille assumed</span>
</span><span id="__span-1-9">
</span><span id="__span-1-10"><span class="nb">print</span><span class="p">(</span><span class="n">myDensity1</span><span class="p">)</span>
</span><span id="__span-1-11"><span class="nb">print</span><span class="p">(</span><span class="n">myDensity2</span><span class="p">)</span>
</span><span id="__span-1-12"><span class="c1"># -&gt; 1023.0511189339445 kilogram / meter ** 3</span>
</span><span id="__span-1-13"><span class="c1"># -&gt; 1023.0511189339445 kilogram / meter ** 3</span>
</span></code></pre></div>
We can see that the water property function have default, assumed units for any given float arguments (you can see these in the docstrings of the respective functions). PAGOS will also automatically convert units of a different kind:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><span class="n">myTemp2</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="mf">283.15</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
</span><span id="__span-2-2"><span class="n">mySal2</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">)</span>
</span><span id="__span-2-3">
</span><span id="__span-2-4"><span class="n">myDensity3</span> <span class="o">=</span> <span class="n">pwater</span><span class="o">.</span><span class="n">calc_dens</span><span class="p">(</span><span class="n">myTemp2</span><span class="p">,</span> <span class="n">mySal2</span><span class="p">)</span>
</span><span id="__span-2-5">
</span><span id="__span-2-6"><span class="nb">print</span><span class="p">(</span><span class="n">myDensity3</span><span class="p">)</span>
</span><span id="__span-2-7"><span class="c1"># -&gt; 1023.0511189339445 kilogram / meter ** 3</span>
</span></code></pre></div>
<p>Other properties available to be calculated for water are vapour pressure over the water and kinematic viscosity of the water, given temperature and salinity:
<div class="language-py highlight"><pre><span></span><code><span id="__span-3-1"><span class="n">myVapourPres</span> <span class="o">=</span> <span class="n">pwater</span><span class="o">.</span><span class="n">calc_vappres</span><span class="p">(</span><span class="n">myTemp1</span><span class="p">)</span>
</span><span id="__span-3-2"><span class="n">myKinVisc</span> <span class="o">=</span> <span class="n">pwater</span><span class="o">.</span><span class="n">calc_kinvisc</span><span class="p">(</span><span class="n">myTemp1</span><span class="p">,</span> <span class="n">mySal1</span><span class="p">)</span>
</span><span id="__span-3-3"><span class="nb">print</span><span class="p">(</span><span class="n">myVapourPres</span><span class="p">)</span>
</span><span id="__span-3-4"><span class="nb">print</span><span class="p">(</span><span class="n">myKinVisc</span><span class="p">)</span>
</span><span id="__span-3-5"><span class="c1"># -&gt; 12.272370555643239 millibar</span>
</span><span id="__span-3-6"><span class="c1"># -&gt; 1.3516218130144556e-06 meter ** 2 / second</span>
</span></code></pre></div></p>
<h2 id="gas-property-calculations">Gas property calculations</h2>
<p>Much like the bulk water properties, properties of gases dissolved in water can also be calculated, namely the equilibrium concentration and the Schmidt number at given temperature, salinity and overlying pressure. Also like the functions in the  <code>water</code> module, the <code>gas</code> module functions have default assumed units which may be overriden by the user. See how all of the following calculations return the same result:
<div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos</span><span class="w"> </span><span class="kn">import</span> <span class="n">gas</span> <span class="k">as</span> <span class="n">pgas</span><span class="p">,</span> <span class="n">Q</span>
</span><span id="__span-4-2"><span class="n">myTemp</span><span class="p">,</span> <span class="n">myTempC</span><span class="p">,</span> <span class="n">myTempK</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">Q</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mf">293.15</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
</span><span id="__span-4-3"><span class="n">mySal</span><span class="p">,</span> <span class="n">mySalpm</span><span class="p">,</span> <span class="n">mySalpc</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">Q</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;permille&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mf">3.2</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">)</span>
</span><span id="__span-4-4"><span class="n">myPres</span><span class="p">,</span> <span class="n">myPresatm</span><span class="p">,</span> <span class="n">myPreshPa</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mf">1013.25</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">)</span>
</span><span id="__span-4-5">
</span><span id="__span-4-6"><span class="n">Ceq1</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">myTemp</span><span class="p">,</span> <span class="n">mySal</span><span class="p">,</span> <span class="n">myPres</span><span class="p">)</span>
</span><span id="__span-4-7"><span class="n">Ceq2</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">myTempC</span><span class="p">,</span> <span class="n">mySalpm</span><span class="p">,</span> <span class="n">myPresatm</span><span class="p">)</span>
</span><span id="__span-4-8"><span class="n">Ceq3</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">myTempK</span><span class="p">,</span> <span class="n">mySalpc</span><span class="p">,</span> <span class="n">myPreshPa</span><span class="p">)</span>
</span><span id="__span-4-9"><span class="n">Sc</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Sc</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">myTemp</span><span class="p">,</span> <span class="n">mySal</span><span class="p">)</span>
</span><span id="__span-4-10">
</span><span id="__span-4-11"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ceq1(Ne):&#39;</span><span class="p">,</span> <span class="n">Ceq1</span><span class="p">)</span>
</span><span id="__span-4-12"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ceq2(Ne):&#39;</span><span class="p">,</span> <span class="n">Ceq2</span><span class="p">)</span>
</span><span id="__span-4-13"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ceq3(Ne):&#39;</span><span class="p">,</span> <span class="n">Ceq3</span><span class="p">)</span>
</span><span id="__span-4-14"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sc(Ne):&#39;</span><span class="p">,</span> <span class="n">Sc</span><span class="p">)</span>
</span><span id="__span-4-15"><span class="c1"># -&gt; Ceq1(Ne): 1.5676847690725347e-07</span>
</span><span id="__span-4-16"><span class="c1"># -&gt; Ceq2(Ne): 1.5676847690725347e-07</span>
</span><span id="__span-4-17"><span class="c1"># -&gt; Ceq3(Ne): 1.567684769072535e-07</span>
</span><span id="__span-4-18"><span class="c1"># -&gt; Sc(Ne): 300.07687253959057 dimensionless</span>
</span></code></pre></div>
Multiple gas properties may be calculated all at once (this is also true of water properties):
<div class="language-py highlight"><pre><span></span><code><span id="__span-5-1"><span class="n">Ceqs</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">([</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s1">&#39;CFC12&#39;</span><span class="p">],</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">myPreshPa</span><span class="p">)</span>
</span><span id="__span-5-2"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ceq(Ne, Ar, N2, CFC12) =&#39;</span><span class="p">,</span> <span class="n">Ceqs</span><span class="p">,</span> <span class="s1">&#39;ccSTP/g&#39;</span><span class="p">)</span>
</span><span id="__span-5-3"><span class="c1"># -&gt; Ceq(Ne, Ar, N2, CFC12) = [1.56768477e-07 2.54842193e-04 9.60586197e-03 2.68527581e-11] ccSTP/g</span>
</span></code></pre></div></p>
<p class="annotate">Note how <code>calc_Ceq</code> returns only a <code>float</code> by default, not a unit-bound <code>Quantity</code>. This is in contrast to most other functions in PAGOS, including <code>calc_Sc</code>, and is set up this way to increase speed when performing inverse modelling(1). The <code>float</code> returned is the value of the equilibrium concentration in units of cc/g, but without the units explicitly returned with it. The unit can be changed, and optionally returned, using the <code>unit</code> and <code>ret_quant</code> arguments:</p>
<ol>
<li>This is set to be changed in a future version of PAGOS; after great speed improvements, this feature is no longer necessary.</li>
</ol>
<p><div class="language-py highlight"><pre><span></span><code><span id="__span-6-1"><span class="n">Ceqsmolkg</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">myPreshPa</span><span class="p">,</span> <span class="s1">&#39;mol/kg&#39;</span><span class="p">)</span>
</span><span id="__span-6-2"><span class="n">Ceqsmolcc</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">myPreshPa</span><span class="p">,</span> <span class="s1">&#39;mol/cc&#39;</span><span class="p">,</span> <span class="n">ret_quant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-3"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ceq(Ne) =&#39;</span><span class="p">,</span> <span class="n">Ceqsmolkg</span><span class="p">)</span>
</span><span id="__span-6-4"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ceq(Ne) =&#39;</span><span class="p">,</span> <span class="n">Ceqsmolcc</span><span class="p">)</span>
</span><span id="__span-6-5"><span class="c1"># -&gt; Ceq(Ne) = 6.9908309248701225e-09</span>
</span><span id="__span-6-6"><span class="c1"># -&gt; Ceq(Ne) = 7.147959263640384e-12 mole / cubic_centimeter</span>
</span></code></pre></div>
Note also here that the different units that one can return are incommensurable with each other (mol/kg has different dimensions to mol/cc). This is another reason why <code>calc_Ceq</code> does not returned a dimensioned object by default - functions in PAGOS which do automatically return dimensioned quantities do so by way of a wrapper, but <code>calc_Ceq</code> cannot be wrapped due to the many incommensurable possibilities of return units.</p>
<h2 id="creating-and-fitting-models">Creating and fitting models</h2>
<p>The real power of PAGOS is in its gas exchange modelling capabilities. PAGOS allows for simple user-definition of gas exchange models. Say we wanted to implement a simple unfractionated excess air (UA) model (that is, equilibrium concentration <span class="arithmatex">\(C^\mathrm{eq}\)</span> "topped up" with an excess air component):</p>
<div class="arithmatex">\[
C_\mathrm{gas}^\mathrm{UA}(T, S, p, A) = C_\mathrm{gas}^\mathrm{eq}(T, S, p) + A\cdot z,
\]</div>
<p>where <span class="arithmatex">\(A\)</span> is in the units of <span class="arithmatex">\(C^\mathrm{eq}_\mathrm{gas}\)</span> and <span class="arithmatex">\(z\)</span> is the atmospheric abundance of the gas. We can implement it very simply like this:
<div class="language-py highlight"><pre><span></span><code><span id="__span-7-1"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos</span><span class="w"> </span><span class="kn">import</span> <span class="n">gas</span> <span class="k">as</span> <span class="n">pgas</span>
</span><span id="__span-7-2"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos.modelling</span><span class="w"> </span><span class="kn">import</span> <span class="n">GasExchangeModel</span>
</span><span id="__span-7-3"><span class="k">def</span><span class="w"> </span><span class="nf">ua_model</span><span class="p">(</span><span class="n">gas</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
</span><span id="__span-7-4">    <span class="n">Ceq</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="n">gas</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="__span-7-5">    <span class="n">z</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">abn</span><span class="p">(</span><span class="n">gas</span><span class="p">)</span>   <span class="c1"># &lt;- pagos.gas.abn(G) returns the dimensionless atmospheric abundance of G</span>
</span><span id="__span-7-6">    <span class="k">return</span> <span class="n">Ceq</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">z</span>
</span><span id="__span-7-7"><span class="n">UAModel</span> <span class="o">=</span> <span class="n">GasExchangeModel</span><span class="p">(</span><span class="n">ua_model</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">,</span> <span class="s1">&#39;permille&#39;</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;cc/g&#39;</span><span class="p">),</span> <span class="s1">&#39;cc/g&#39;</span><span class="p">)</span>
</span></code></pre></div>
The arguments to <code>GasExchangeModel()</code> are the user-defined function describing the model (<code>ua_model</code> above), a tuple of default input units (<code>('degC', 'permille', 'atm', 'cc/g')</code> above) and one default output unit (<code>'cc/g'</code> above). The default input units correspond to the assumed units of the arguments of the model function (<code>(T, S, p, A)</code> above). The output units are those in which the result of the model is expressed. To calculate the result of a model for a given gas, use the <code>run()</code> method of <code>GasExchangeModel</code>. Note that they are <strong>default</strong> units, but can be overridden:
<div class="language-py highlight"><pre><span></span><code><span id="__span-8-1"><span class="c1"># no given units, default units assumed</span>
</span><span id="__span-8-2"><span class="n">myResult1</span> <span class="o">=</span> <span class="n">UAModel</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">)</span>
</span><span id="__span-8-3"><span class="c1"># units manually given but are the same as the defaults</span>
</span><span id="__span-8-4"><span class="n">myResult2</span> <span class="o">=</span> <span class="n">UAModel</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">Q</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;permille&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">,</span> <span class="s1">&#39;cc/g&#39;</span><span class="p">))</span>
</span><span id="__span-8-5"><span class="c1"># non-default units included, default units of degC and permille overridden</span>
</span><span id="__span-8-6"><span class="n">myResult3</span> <span class="o">=</span> <span class="n">UAModel</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="n">Q</span><span class="p">(</span><span class="mf">283.15</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">),</span> <span class="n">Q</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">)</span>
</span><span id="__span-8-7">
</span><span id="__span-8-8"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Result with no given units:&#39;</span><span class="p">,</span> <span class="n">myResult1</span><span class="p">)</span>
</span><span id="__span-8-9"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Result with given units matching defaults:&#39;</span><span class="p">,</span> <span class="n">myResult2</span><span class="p">)</span>
</span><span id="__span-8-10"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Result with overridden units:&#39;</span><span class="p">,</span> <span class="n">myResult3</span><span class="p">)</span>
</span><span id="__span-8-11"><span class="c1"># -&gt; Result with no given units: 1.7903293005762066e-07 cubic_centimeter / gram</span>
</span><span id="__span-8-12"><span class="c1"># -&gt; Result with given units matching defaults: 1.7903293005762066e-07 cubic_centimeter / gram</span>
</span><span id="__span-8-13"><span class="c1"># -&gt; Result with overridden units: 1.7903293005762066e-07 cubic_centimeter / gram</span>
</span></code></pre></div>
If repeatedly typing the <code>Q()</code> constructor isn't to your liking, one can also override default units with the <code>units_in</code> argument thus:
<div class="language-py highlight"><pre><span></span><code><span id="__span-9-1"><span class="n">myResult4</span> <span class="o">=</span> <span class="n">UAModel</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="mf">283.15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">,</span> <span class="n">units_in</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;cc/g&#39;</span><span class="p">])</span>
</span><span id="__span-9-2"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Result using units_in kwarg:&#39;</span><span class="p">,</span> <span class="n">myResult4</span><span class="p">)</span>
</span><span id="__span-9-3"><span class="c1"># -&gt; Result using units_in kwarg: 1.7903293005762066e-07 cubic_centimeter / gram</span>
</span></code></pre></div></p>
<p>The returned units may also be altered with the units_out keyword argument. Additionally, note in the example below that the <code>'percent'</code> in <code>units_in</code> is overridden by the explicit <code>Quantity</code> object with its already given <code>'permille'</code> unit. This is a nice safeguard, but also a good reason <strong>not</strong> to use the <code>units_in</code> argument along with <code>Q()</code>-based model arguments, as <code>units_in</code> will always be silently overridden.
<div class="language-py highlight"><pre><span></span><code><span id="__span-10-1"><span class="n">myResult5</span> <span class="o">=</span> <span class="n">UAModel</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">Q</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;permille&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">,</span> <span class="n">units_in</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;degC&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;cc/g&#39;</span><span class="p">],</span> <span class="n">units_out</span><span class="o">=</span><span class="s1">&#39;m^3/kg&#39;</span><span class="p">)</span>
</span><span id="__span-10-2"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Result in using units_out kwarg:&#39;</span><span class="p">,</span> <span class="n">myResult5</span><span class="p">)</span>
</span><span id="__span-10-3"><span class="c1"># -&gt; Result in using units_out kwarg: 1.790329300576207e-10 meter ** 3 / kilogram</span>
</span></code></pre></div></p>
<h2 id="inverse-modelling">Inverse Modelling</h2>
<p>Parameters of a <code>GasExchangeModel</code>'s function can be fitted using data. A better walkthrough can be found in the <code>example scripts</code> folder, but here is a brief explanation. The <code>GasExchangeModel.fit()</code> method can be used to fit a number of parameters of a gas exchange model using a least-squares minimisation. Here is an example using the Belgium data (from <a href="https://doi.org/10.1016/j.envsoft.2018.02.004">Jung and Aeschbach 2018</a>) taken from the <code>example scripts/example data</code> folder:
<div class="language-py highlight"><pre><span></span><code><span id="__span-11-1"><span class="kn">from</span><span class="w"> </span><span class="nn">pagos.modelling</span><span class="w"> </span><span class="kn">import</span> <span class="n">fitmodel</span>
</span><span id="__span-11-2"><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-11-3">
</span><span id="__span-11-4"><span class="c1"># Data import</span>
</span><span id="__span-11-5"><span class="c1"># These data are from Jung and Aeschbach 2018 (https://www.sciencedirect.com/science/article/pii/S1364815216307150)</span>
</span><span id="__span-11-6"><span class="n">gases_used</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">,</span> <span class="s1">&#39;Kr&#39;</span><span class="p">,</span> <span class="s1">&#39;Xe&#39;</span><span class="p">]</span>
</span><span id="__span-11-7"><span class="n">pangadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;example scripts/Example Data/Complete_Input_Data_Samples_Belgium.CSV&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="__span-11-8"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data from Jung and Aeschbach 2018:&#39;</span><span class="p">)</span>
</span><span id="__span-11-9"><span class="nb">print</span><span class="p">(</span><span class="n">pangadata</span><span class="p">)</span>
</span><span id="__span-11-10">
</span><span id="__span-11-11"><span class="k">def</span><span class="w"> </span><span class="nf">ua_model</span><span class="p">(</span><span class="n">gas</span><span class="p">,</span> <span class="n">T_recharge</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
</span><span id="__span-11-12">    <span class="n">Ceq</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">calc_Ceq</span><span class="p">(</span><span class="n">gas</span><span class="p">,</span> <span class="n">T_recharge</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="__span-11-13">    <span class="n">z</span> <span class="o">=</span> <span class="n">pgas</span><span class="o">.</span><span class="n">abn</span><span class="p">(</span><span class="n">gas</span><span class="p">)</span>
</span><span id="__span-11-14">    <span class="k">return</span> <span class="n">Ceq</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="n">z</span>
</span><span id="__span-11-15"><span class="n">UAModel</span> <span class="o">=</span> <span class="n">GasExchangeModel</span><span class="p">(</span><span class="n">ua_model</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">,</span> <span class="s1">&#39;permille&#39;</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;cc/g&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-11-16">
</span><span id="__span-11-17"><span class="n">fit_UA</span> <span class="o">=</span> <span class="n">UAModel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pangadata</span><span class="p">,</span>                                             <span class="c1"># the data as a Pandas DataFrame</span>
</span><span id="__span-11-18">                     <span class="n">to_fit</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T_recharge&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>                            <span class="c1"># the arguments of the model we would like to fit</span>
</span><span id="__span-11-19">                     <span class="n">init_guess</span><span class="o">=</span><span class="p">[</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="mf">1e-5</span><span class="p">],</span>                       <span class="c1"># the initial guesses for the parameters to be fit</span>
</span><span id="__span-11-20">                     <span class="n">tracers_used</span><span class="o">=</span><span class="n">gases_used</span><span class="p">,</span>                               <span class="c1"># the tracers used for the fitting procedure</span>
</span><span id="__span-11-21">                     <span class="n">constraints</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">]],</span>                    <span class="c1"># any (optional) constraints we might want to place on our fitted parameters</span>
</span><span id="__span-11-22">                     <span class="n">tqdm_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                         <span class="c1"># whether to display a progress bar</span>
</span><span id="__span-11-23"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fit of UA model:&#39;</span><span class="p">)</span>
</span><span id="__span-11-24"><span class="nb">print</span><span class="p">(</span><span class="n">fit_UA</span><span class="p">)</span>
</span><span id="__span-11-25">
</span><span id="__span-11-26"><span class="c1"># -&gt; Fit of UA model</span>
</span><span id="__span-11-27"><span class="c1">#                        T_recharge                                           A</span>
</span><span id="__span-11-28"><span class="c1">#    0     7.1+/-0.9 degree_Celsius     0.0023+/-0.0006 cubic_centimeter / gram</span>
</span><span id="__span-11-29"><span class="c1">#    1     5.0+/-0.4 degree_Celsius   0.00348+/-0.00029 cubic_centimeter / gram</span>
</span><span id="__span-11-30"><span class="c1">#    2     5.0+/-0.4 degree_Celsius   0.00098+/-0.00022 cubic_centimeter / gram</span>
</span><span id="__span-11-31"><span class="c1">#    .                 .                                 .</span>
</span><span id="__span-11-32"><span class="c1">#    .                 .                                 .</span>
</span><span id="__span-11-33"><span class="c1">#    .                 .                                 .</span>
</span></code></pre></div>
The arguments are explained in the method docstrings and on the right hand side above. Note here that the init_guess arguments do NOT have to be Quantity objects, although they can be for clarity/safety, if you want. When units are omitted, the <code>default_units_in</code> passed to the <code>GasExchangeModel()</code> constructor are used. So in this case, <code>1e-5</code> becomes <code>1e-5 cc/g</code>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Home
              </div>
            </div>
          </a>
        
        
          
          <a href="../../User%20Guide/Quantities%20and%20Magnitudes/" class="md-footer__link md-footer__link--next" aria-label="Next: Quantities and Magnitudes">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Quantities and Magnitudes
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024&mdash;2025 Stanley Scott and Chiara Hubner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.tooltips", "content.code.annotate", "content.code.copy", "navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.path", "navigation.indexes", "navigation.footer", "toc.follow", "search.suggest", "search.share"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>